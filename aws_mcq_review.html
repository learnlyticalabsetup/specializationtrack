<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCQ Questions Review - Question Review</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #232f3e, #ff9900);
            color: white;
            padding: 30px 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }

        .controls label {
            font-weight: bold;
            margin-right: 10px;
        }

        .controls select, .controls input {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .controls select:focus, .controls input:focus {
            outline: none;
            border-color: #ff9900;
        }

        .stats {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #232f3e;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }

        .question-card {
            background: white;
            margin-bottom: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.2s ease;
        }

        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .question-header {
            background: #232f3e;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .question-number {
            font-weight: bold;
            font-size: 1.1em;
        }

        .question-topic {
            background: #ff9900;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .question-set {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }

        .question-content {
            padding: 20px;
        }

        .question-text {
            font-size: 1.1em;
            margin-bottom: 20px;
            line-height: 1.8;
            color: #2c3e50;
            font-weight: 500;
        }

        .options-container {
            display: grid;
            gap: 12px;
        }

        .option {
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: #f8f9fa;
            transition: all 0.2s ease;
            display: flex;
            align-items: flex-start;
        }

        .option.correct {
            border-color: #28a745;
            background: #d4edda;
            color: #155724;
        }

        .option-label {
            font-weight: bold;
            margin-right: 12px;
            min-width: 25px;
            color: #232f3e;
        }

        .option.correct .option-label {
            color: #155724;
        }

        .option-text {
            flex: 1;
        }

        .correct-indicator {
            margin-left: auto;
            color: #28a745;
            font-weight: bold;
        }

        .search-highlight {
            background-color: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .no-results {
            text-align: center;
            padding: 50px;
            color: #666;
            font-size: 1.2em;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #666;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2em;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .controls > div {
                display: flex;
                flex-direction: column;
                gap: 5px;
            }

            .question-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .stats {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .pagination button {
            padding: 10px 15px;
            border: 2px solid #232f3e;
            background: white;
            color: #232f3e;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pagination button:hover:not(:disabled) {
            background: #232f3e;
            color: white;
        }

        .pagination button.active {
            background: #ff9900;
            border-color: #ff9900;
            color: white;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-info {
            margin: 0 15px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
                        <h1>üìã Question Review - MCQ Bank</h1>
                        <p>Comprehensive collection of 650 case study-driven questions across 3 difficulty levels</p>
        </div>

        <div class="stats" id="stats">
            <div class="stat-item">
                <div class="stat-number" id="totalQuestions">650</div>
                <div class="stat-label">Total Questions</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="filteredQuestions">650</div>
                <div class="stat-label">Displayed Questions</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="totalTopics">30+</div>
                <div class="stat-label">AWS Topics Covered</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">3</div>
                <div class="stat-label">Question Sets</div>
            </div>
        </div>

        <div class="controls">
            <div>
                <label for="topicFilter">Filter by Topic:</label>
                <select id="topicFilter">
                    <option value="">All Topics</option>
                </select>
            </div>
            <div>
                <label for="setFilter">Filter by Set:</label>
                <select id="setFilter">
                    <option value="">All Sets</option>
                    <option value="Set 1">Set 1 (300 questions)</option>
                    <option value="Set 2">Set 2 (150 questions)</option>
                    <option value="Set 3">Set 3 (200 complex questions)</option>
                </select>
            </div>
            <div>
                <label for="searchInput">Search Questions:</label>
                <input type="text" id="searchInput" placeholder="Search by question text, options, or topic...">
            </div>
            <div>
                <label for="questionsPerPage">Questions per page:</label>
                <select id="questionsPerPage">
                    <option value="10">10</option>
                    <option value="25" selected>25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                    <option value="all">All</option>
                </select>
            </div>
        </div>

        <div class="pagination" id="topPagination"></div>

        <div id="questionsContainer">
            <div class="loading">Loading questions...</div>
        </div>

        <div class="pagination" id="bottomPagination"></div>
    </div>

    <script>
        let allQuestions = [];
        let filteredQuestions = [];
        let currentPage = 1;
        let questionsPerPage = 25;

        // Sample data structure - in production, this would load from CSV files
        const sampleQuestions = [
            // This will be populated with actual data from the CSV files
        ];

        // Function to parse CSV data
        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const headers = lines[0].split(',').map(h => h.replace(/"/g, '').trim());
            const questions = [];
            
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = parseCSVLine(lines[i]);
                    if (values.length >= 6) {
                        questions.push({
                            question: values[0],
                            optionA: values[1],
                            optionB: values[2],
                            optionC: values[3],
                            optionD: values[4],
                            correctAnswer: values[5],
                            topic: values[6] || 'General'
                        });
                    }
                }
            }
            return questions;
        }

        // Function to parse CSV line handling quoted content
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current.trim());
            return result.map(item => item.replace(/^"|"$/g, ''));
        }

        // Initialize the application
        async function initializeApp() {
            try {
                // Load questions from all three CSV files
                const set1Response = await fetch('./aws_mcq_300_questions.csv');
                const set2Response = await fetch('./aws_mcq_set2_150_questions.csv');
                const set3Response = await fetch('./aws_mcq_set3_200_questions.csv');
                
                if (set1Response.ok) {
                    const set1Text = await set1Response.text();
                    const set1Questions = parseCSV(set1Text).map(q => ({...q, set: 'Set 1'}));
                    allQuestions = allQuestions.concat(set1Questions);
                }
                
                if (set2Response.ok) {
                    const set2Text = await set2Response.text();
                    const set2Questions = parseCSV(set2Text).map(q => ({...q, set: 'Set 2'}));
                    allQuestions = allQuestions.concat(set2Questions);
                }

                if (set3Response.ok) {
                    const set3Text = await set3Response.text();
                    const set3Questions = parseCSV(set3Text).map(q => ({...q, set: 'Set 3'}));
                    allQuestions = allQuestions.concat(set3Questions);
                }

                // If CSV files are not available, use sample data
                if (allQuestions.length === 0) {
                    allQuestions = generateSampleQuestions();
                }

                filteredQuestions = [...allQuestions];
                populateTopicFilter();
                updateStats();
                renderQuestions();
                setupEventListeners();
                
            } catch (error) {
                console.error('Error loading questions:', error);
                allQuestions = generateSampleQuestions();
                filteredQuestions = [...allQuestions];
                populateTopicFilter();
                updateStats();
                renderQuestions();
                setupEventListeners();
            }
        }

        // Generate sample questions for demonstration
        function generateSampleQuestions() {
            const topics = [
                "Cloud Introduction,VPC design, Transit Gateway, PrivateLink",
                "EC2, Auto Scaling, Elastic Load Balancing",
                "AWS Security Hub: integrations, findings, standards",
                "S3, Glacier, EBS, EFS, FSx",
                "Multi-Service Architecture Integration"
            ];
            
            const sampleQuestions = [];
            
            for (let i = 1; i <= 650; i++) {
                let setNumber;
                if (i <= 300) setNumber = 'Set 1';
                else if (i <= 450) setNumber = 'Set 2';
                else setNumber = 'Set 3';
                
                const topicIndex = (i - 1) % topics.length;
                
                sampleQuestions.push({
                    question: `Sample question ${i}: A company needs to implement AWS services for their cloud infrastructure. What is the best approach for this scenario?`,
                    optionA: `Option A for question ${i}`,
                    optionB: `Option B for question ${i}`,
                    optionC: `Option C for question ${i}`,
                    optionD: `Option D for question ${i}`,
                    correctAnswer: ['A', 'B', 'C', 'D'][i % 4],
                    topic: topics[topicIndex],
                    set: setNumber
                });
            }
            
            return sampleQuestions;
        }

        // Populate topic filter dropdown
        function populateTopicFilter() {
            const topics = [...new Set(allQuestions.map(q => q.topic))].sort();
            const topicFilter = document.getElementById('topicFilter');
            
            topicFilter.innerHTML = '<option value="">All Topics</option>';
            topics.forEach(topic => {
                const option = document.createElement('option');
                option.value = topic;
                option.textContent = topic;
                topicFilter.appendChild(option);
            });
        }

        // Update statistics
        function updateStats() {
            document.getElementById('totalQuestions').textContent = allQuestions.length;
            document.getElementById('filteredQuestions').textContent = filteredQuestions.length;
            document.getElementById('totalTopics').textContent = new Set(allQuestions.map(q => q.topic)).size;
        }

        // Filter questions
        function filterQuestions() {
            const topicFilter = document.getElementById('topicFilter').value;
            const setFilter = document.getElementById('setFilter').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            filteredQuestions = allQuestions.filter(question => {
                const matchesTopic = !topicFilter || question.topic === topicFilter;
                const matchesSet = !setFilter || question.set === setFilter;
                const matchesSearch = !searchTerm || 
                    question.question.toLowerCase().includes(searchTerm) ||
                    question.optionA.toLowerCase().includes(searchTerm) ||
                    question.optionB.toLowerCase().includes(searchTerm) ||
                    question.optionC.toLowerCase().includes(searchTerm) ||
                    question.optionD.toLowerCase().includes(searchTerm) ||
                    question.topic.toLowerCase().includes(searchTerm);

                return matchesTopic && matchesSet && matchesSearch;
            });

            currentPage = 1;
            updateStats();
            renderQuestions();
        }

        // Render questions
        function renderQuestions() {
            const container = document.getElementById('questionsContainer');
            const perPage = document.getElementById('questionsPerPage').value;
            
            if (filteredQuestions.length === 0) {
                container.innerHTML = '<div class="no-results">No questions found matching your criteria.</div>';
                updatePagination();
                return;
            }

            let questionsToShow;
            if (perPage === 'all') {
                questionsToShow = filteredQuestions;
                questionsPerPage = filteredQuestions.length;
            } else {
                questionsPerPage = parseInt(perPage);
                const startIndex = (currentPage - 1) * questionsPerPage;
                const endIndex = startIndex + questionsPerPage;
                questionsToShow = filteredQuestions.slice(startIndex, endIndex);
            }

            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            container.innerHTML = questionsToShow.map((question, index) => {
                const globalIndex = perPage === 'all' ? index + 1 : (currentPage - 1) * questionsPerPage + index + 1;
                const originalIndex = allQuestions.indexOf(question) + 1;
                
                return `
                    <div class="question-card">
                        <div class="question-header">
                            <span class="question-number">Question ${globalIndex} (Original #${originalIndex})</span>
                            <div style="display: flex; gap: 10px; margin-left: auto;">
                                <span class="question-set">${question.set}</span>
                                <span class="question-topic">${question.topic}</span>
                            </div>
                        </div>
                        <div class="question-content">
                            <div class="question-text">${highlightSearchTerm(question.question, searchTerm)}</div>
                            <div class="options-container">
                                <div class="option ${question.correctAnswer === 'A' ? 'correct' : ''}">
                                    <span class="option-label">A.</span>
                                    <span class="option-text">${highlightSearchTerm(question.optionA, searchTerm)}</span>
                                    ${question.correctAnswer === 'A' ? '<span class="correct-indicator">‚úì Correct</span>' : ''}
                                </div>
                                <div class="option ${question.correctAnswer === 'B' ? 'correct' : ''}">
                                    <span class="option-label">B.</span>
                                    <span class="option-text">${highlightSearchTerm(question.optionB, searchTerm)}</span>
                                    ${question.correctAnswer === 'B' ? '<span class="correct-indicator">‚úì Correct</span>' : ''}
                                </div>
                                <div class="option ${question.correctAnswer === 'C' ? 'correct' : ''}">
                                    <span class="option-label">C.</span>
                                    <span class="option-text">${highlightSearchTerm(question.optionC, searchTerm)}</span>
                                    ${question.correctAnswer === 'C' ? '<span class="correct-indicator">‚úì Correct</span>' : ''}
                                </div>
                                <div class="option ${question.correctAnswer === 'D' ? 'correct' : ''}">
                                    <span class="option-label">D.</span>
                                    <span class="option-text">${highlightSearchTerm(question.optionD, searchTerm)}</span>
                                    ${question.correctAnswer === 'D' ? '<span class="correct-indicator">‚úì Correct</span>' : ''}
                                </div>
                            </div>
                            <div class="comment-section" style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                                <div class="comment-form">
                                    <h4 style="color: #232f3e; margin-bottom: 10px; font-size: 1.1em;">üí¨ Add Review Comment</h4>
                                    <textarea 
                                        id="comment-${originalIndex}" 
                                        placeholder="Share your feedback about this question (quality, clarity, difficulty, etc.)"
                                        style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; resize: vertical; min-height: 80px; font-family: inherit; margin-bottom: 10px;"
                                    ></textarea>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select id="rating-${originalIndex}" style="padding: 8px; border: 2px solid #ddd; border-radius: 5px;">
                                            <option value="">Rate this question</option>
                                            <option value="excellent">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent</option>
                                            <option value="good">‚≠ê‚≠ê‚≠ê‚≠ê Good</option>
                                            <option value="average">‚≠ê‚≠ê‚≠ê Average</option>
                                            <option value="poor">‚≠ê‚≠ê Poor</option>
                                            <option value="very-poor">‚≠ê Very Poor</option>
                                        </select>
                                        <button 
                                            onclick="submitComment('mcq', ${originalIndex}, '${question.set}', '${question.topic.replace(/'/g, "\\'")}', '${question.question.substring(0, 50).replace(/'/g, "\\'")}...')"
                                            style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                            Submit Comment
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            updatePagination();
        }

        // Highlight search terms
        function highlightSearchTerm(text, searchTerm) {
            if (!searchTerm) return text;
            
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<span class="search-highlight">$1</span>');
        }

        // Update pagination
        function updatePagination() {
            const perPage = document.getElementById('questionsPerPage').value;
            const topPagination = document.getElementById('topPagination');
            const bottomPagination = document.getElementById('bottomPagination');
            
            if (perPage === 'all' || filteredQuestions.length <= questionsPerPage) {
                topPagination.innerHTML = '';
                bottomPagination.innerHTML = '';
                return;
            }

            const totalPages = Math.ceil(filteredQuestions.length / questionsPerPage);
            const paginationHTML = createPaginationHTML(totalPages);
            
            topPagination.innerHTML = paginationHTML;
            bottomPagination.innerHTML = paginationHTML;
        }

        // Create pagination HTML
        function createPaginationHTML(totalPages) {
            let html = '';
            
            // Previous button
            html += `<button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>Previous</button>`;
            
            // Page numbers
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, currentPage + 2);
            
            if (startPage > 1) {
                html += `<button onclick="changePage(1)">1</button>`;
                if (startPage > 2) html += '<span>...</span>';
            }
            
            for (let i = startPage; i <= endPage; i++) {
                html += `<button onclick="changePage(${i})" ${i === currentPage ? 'class="active"' : ''}>${i}</button>`;
            }
            
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) html += '<span>...</span>';
                html += `<button onclick="changePage(${totalPages})">${totalPages}</button>`;
            }
            
            // Next button
            html += `<button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Next</button>`;
            
            // Page info
            html += `<span class="pagination-info">Page ${currentPage} of ${totalPages}</span>`;
            
            return html;
        }

        // Change page
        function changePage(page) {
            const totalPages = Math.ceil(filteredQuestions.length / questionsPerPage);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                renderQuestions();
                window.scrollTo(0, 0);
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('topicFilter').addEventListener('change', filterQuestions);
            document.getElementById('setFilter').addEventListener('change', filterQuestions);
            document.getElementById('searchInput').addEventListener('input', debounce(filterQuestions, 300));
            document.getElementById('questionsPerPage').addEventListener('change', () => {
                currentPage = 1;
                renderQuestions();
            });
        }

        // Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication first
            if (!checkAuthentication()) {
                document.querySelector('.container').style.filter = 'blur(5px)';
                document.querySelector('.container').style.pointerEvents = 'none';
                return;
            }
            
            // Add logout button
            const username = sessionStorage.getItem('aws_username');
            const userRole = sessionStorage.getItem('aws_user_role');
            addLogoutButton(username);
            
            // Add admin panel if user is admin
            if (userRole === 'admin') {
                addAdminPanel();
            }
            
            // Initialize the app
            initializeApp();
        });

        // Comment System Functions
        function submitComment(type, itemId, category, topic, title) {
            const commentText = document.getElementById(`comment-${itemId}`).value.trim();
            const rating = document.getElementById(`rating-${itemId}`).value;
            const username = sessionStorage.getItem('aws_username');
            
            if (!commentText) {
                alert('Please enter a comment before submitting.');
                return;
            }
            
            const comment = {
                timestamp: new Date().toISOString(),
                user: username,
                type: type, // 'mcq', 'assignment', 'capstone'
                itemId: itemId,
                category: category,
                topic: topic,
                title: title,
                comment: commentText,
                rating: rating,
                id: Date.now() + Math.random()
            };
            
            // Save to localStorage
            saveComment(comment);
            
            // Clear form
            document.getElementById(`comment-${itemId}`).value = '';
            document.getElementById(`rating-${itemId}`).value = '';
            
            // Show success message
            showSuccessMessage('Comment submitted successfully!');
        }

        function saveComment(comment) {
            const existingComments = JSON.parse(localStorage.getItem('aws_review_comments') || '[]');
            existingComments.push(comment);
            localStorage.setItem('aws_review_comments', JSON.stringify(existingComments));
        }

        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #28a745;
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 4px 16px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: slideIn 0.5s ease-out;
            `;
            successDiv.textContent = message;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                if (successDiv.parentNode) {
                    successDiv.remove();
                }
            }, 3000);
        }

        function addAdminPanel() {
            const header = document.querySelector('.header');
            const adminButton = document.createElement('button');
            adminButton.style.cssText = `
                position: absolute;
                top: 20px;
                left: 20px;
                background: #dc3545;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-weight: bold;
            `;
            adminButton.textContent = 'üë§ Admin Panel';
            adminButton.onclick = showAdminPanel;
            header.appendChild(adminButton);
        }

        function showAdminPanel() {
            const comments = JSON.parse(localStorage.getItem('aws_review_comments') || '[]');
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: white;
                    padding: 30px;
                    border-radius: 15px;
                    max-width: 90%;
                    max-height: 90%;
                    overflow-y: auto;
                    width: 1000px;
                ">
                    <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 20px;">
                        <h2 style="color: #232f3e;">üë§ Admin Panel - Review Comments</h2>
                        <div style="margin-left: auto; display: flex; gap: 10px;">
                            <button onclick="downloadCommentsCSV()" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                                üì• Download CSV
                            </button>
                            <button onclick="clearAllComments()" style="background: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                                üóëÔ∏è Clear All
                            </button>
                            <button onclick="closeAdminPanel()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                                ‚úñÔ∏è Close
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>Total Comments: ${comments.length}</strong>
                        <div style="display: flex; gap: 20px; margin-top: 10px;">
                            <span>MCQ Comments: ${comments.filter(c => c.type === 'mcq').length}</span>
                            <span>Assignment Comments: ${comments.filter(c => c.type === 'assignment').length}</span>
                            <span>Capstone Comments: ${comments.filter(c => c.type === 'capstone').length}</span>
                        </div>
                    </div>
                    
                    <div id="commentsContainer" style="max-height: 400px; overflow-y: auto;">
                        ${comments.length === 0 ? '<p>No comments yet.</p>' : comments.map(comment => `
                            <div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 8px; background: #f8f9fa;">
                                <div style="font-weight: bold; color: #232f3e; margin-bottom: 5px;">
                                    ${comment.type.toUpperCase()} #${comment.itemId} - ${comment.topic}
                                </div>
                                <div style="font-size: 0.9em; color: #666; margin-bottom: 10px;">
                                    By: ${comment.user} | ${new Date(comment.timestamp).toLocaleString()} 
                                    ${comment.rating ? `| Rating: ${comment.rating}` : ''}
                                </div>
                                <div style="background: white; padding: 10px; border-radius: 5px; border-left: 4px solid #007bff;">
                                    ${comment.comment}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function closeAdminPanel() {
            const modal = document.querySelector('div[style*="position: fixed"][style*="rgba(0,0,0,0.8)"]');
            if (modal) modal.remove();
        }

        function downloadCommentsCSV() {
            const comments = JSON.parse(localStorage.getItem('aws_review_comments') || '[]');
            
            if (comments.length === 0) {
                alert('No comments to download.');
                return;
            }
            
            const csvHeaders = ['Timestamp', 'User', 'Type', 'Item ID', 'Category', 'Topic', 'Title', 'Rating', 'Comment'];
            const csvRows = comments.map(comment => [
                comment.timestamp,
                comment.user,
                comment.type,
                comment.itemId,
                comment.category || '',
                comment.topic || '',
                comment.title || '',
                comment.rating || '',
                `"${comment.comment.replace(/"/g, '""')}"`
            ]);
            
            const csvContent = [csvHeaders, ...csvRows].map(row => row.join(',')).join('\\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `aws_review_comments_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function clearAllComments() {
            if (confirm('Are you sure you want to delete all comments? This action cannot be undone.')) {
                localStorage.removeItem('aws_review_comments');
                closeAdminPanel();
                alert('All comments have been cleared.');
            }
        }

        // Authentication functions (same as index.html)
        function checkAuthentication() {
            const isAuthenticated = sessionStorage.getItem('aws_authenticated');
            if (!isAuthenticated) {
                showLoginModal();
                return false;
            }
            return true;
        }

        function showLoginModal() {
            const modal = document.createElement('div');
            modal.id = 'loginModal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: white;
                    padding: 40px;
                    border-radius: 15px;
                    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
                    max-width: 400px;
                    width: 90%;
                    text-align: center;
                ">
                    <h2 style="color: #232f3e; margin-bottom: 20px;">üîí Question Review Access</h2>
                    <p style="color: #666; margin-bottom: 25px;">Please enter your authorized reviewer credentials</p>
                    
                    <div style="margin-bottom: 15px;">
                        <input type="text" id="username" placeholder="Username" style="
                            width: 100%;
                            padding: 12px;
                            border: 2px solid #ddd;
                            border-radius: 8px;
                            font-size: 16px;
                            box-sizing: border-box;
                        ">
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <input type="password" id="password" placeholder="Password" style="
                            width: 100%;
                            padding: 12px;
                            border: 2px solid #ddd;
                            border-radius: 8px;
                            font-size: 16px;
                            box-sizing: border-box;
                        ">
                    </div>
                    
                    <button onclick="attemptLogin()" style="
                        background: #ff9900;
                        color: white;
                        border: none;
                        padding: 12px 30px;
                        border-radius: 8px;
                        font-size: 16px;
                        font-weight: bold;
                        cursor: pointer;
                        width: 100%;
                        margin-bottom: 15px;
                    ">üöÄ Access Questions</button>
                    
                    <button onclick="window.location.href='./index.html'" style="
                        background: #6c757d;
                        color: white;
                        border: none;
                        padding: 8px 20px;
                        border-radius: 5px;
                        font-size: 14px;
                        cursor: pointer;
                        width: 100%;
                        margin-bottom: 15px;
                    ">‚Üê Back to Main Page</button>
                    
                    <div id="loginError" style="color: #dc3545; margin-top: 10px; display: none;"></div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            setTimeout(() => {
                document.getElementById('username').focus();
            }, 100);
            
            modal.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    attemptLogin();
                }
            });
        }

        function attemptLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('loginError');
            
            // Valid credentials: reviewer and admin
            const isValid = (username === 'reviewer' && password === 'Review3r2025!') ||
                           (username === 'admin' && password === 'AdminAWS2025!');
            
            if (isValid) {
                sessionStorage.setItem('aws_authenticated', 'true');
                sessionStorage.setItem('aws_username', username);
                sessionStorage.setItem('aws_user_role', username === 'admin' ? 'admin' : 'reviewer');
                sessionStorage.setItem('aws_login_time', new Date().toISOString());
                
                document.getElementById('loginModal').remove();
                document.querySelector('.container').style.filter = 'none';
                document.querySelector('.container').style.pointerEvents = 'auto';
                
                const username_display = sessionStorage.getItem('aws_username');
                addLogoutButton(username_display);
                initializeApp();
            } else {
                errorDiv.style.display = 'block';
                errorDiv.textContent = '‚ùå Invalid credentials. Please contact administrator for access.';
                document.getElementById('password').value = '';
                document.getElementById('password').focus();
            }
        }

        function addLogoutButton(username) {
            const header = document.querySelector('.header');
            const logoutDiv = document.createElement('div');
            logoutDiv.style.cssText = `
                position: absolute;
                top: 20px;
                right: 20px;
                display: flex;
                align-items: center;
                gap: 15px;
                color: white;
            `;
            
            logoutDiv.innerHTML = `
                <span style="font-size: 14px; opacity: 0.9;">üë§ ${username}</span>
                <button onclick="logout()" style="
                    background: rgba(255,255,255,0.2);
                    color: white;
                    border: 1px solid rgba(255,255,255,0.3);
                    padding: 8px 15px;
                    border-radius: 5px;
                    font-size: 12px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                " onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">üö™ Logout</button>
                <button onclick="window.location.href='./index.html'" style="
                    background: rgba(255,255,255,0.2);
                    color: white;
                    border: 1px solid rgba(255,255,255,0.3);
                    padding: 8px 15px;
                    border-radius: 5px;
                    font-size: 12px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                " onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">üè† Home</button>
            `;
            
            header.style.position = 'relative';
            header.appendChild(logoutDiv);
        }

        function logout() {
            sessionStorage.removeItem('aws_authenticated');
            sessionStorage.removeItem('aws_username');
            sessionStorage.removeItem('aws_login_time');
            location.reload();
        }
    </script>
</body>
</html>